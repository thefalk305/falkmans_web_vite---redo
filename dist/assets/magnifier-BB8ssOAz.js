let b=new WeakMap,l=new Map,a=null;const I={checkboxID:"mag-checkbox",zoomInputID:"mag",defaultZoom:2};function z({checkboxID:r="mag-checkbox",zoomInputID:f="mag",defaultZoom:p=2}={}){document.querySelectorAll(".img-magnifier-glass").forEach(e=>e.remove()),l.clear();const E=document.getElementById(r),v=document.getElementById(f),k=document.querySelectorAll(".magImage");let w=E?.checked,n=parseFloat(v?.value)||p;w&&(k.forEach(e=>{const i=b.get(e);i&&(e.removeEventListener("mousemove",i.mouse),e.removeEventListener("touchmove",i.touch));const t=document.createElement("div");t.className="img-magnifier-glass",t.style.pointerEvents="none",e.parentElement.insertBefore(t,e);const d=()=>{const s=e.getBoundingClientRect();t.style.backgroundSize=`${s.width*n}px ${s.height*n}px`};t.style.backgroundImage=`url('${e.src}')`,t.style.backgroundRepeat="no-repeat",d(),l.set(e,t);const u=s=>{s.preventDefault();const o=e.getBoundingClientRect(),c=s.clientX-o.left,m=s.clientY-o.top;if(c<0||m<0||c>o.width||m>o.height){t.style.display="none";return}t.style.display="block";const g=t.offsetWidth/2,h=t.offsetHeight/2,y=Math.max(g/n,Math.min(c,o.width-g/n)),x=Math.max(h/n,Math.min(m,o.height-h/n));t.style.left=`${y+e.offsetLeft-g}px`,t.style.top=`${x+e.offsetTop-h}px`;const M=y/o.width*(o.width*n)-g,$=x/o.height*(o.height*n)-h;t.style.backgroundPosition=`-${M}px -${$}px`};e.addEventListener("mousemove",u),e.addEventListener("touchmove",u,{passive:!1}),b.set(e,{mouse:u,touch:u}),a||(a=new ResizeObserver(()=>{l.forEach((s,o)=>{const c=o.getBoundingClientRect();s.style.backgroundSize=`${c.width*n}px ${c.height*n}px`})})),a.observe(e)}),v?.addEventListener("input",e=>{n=parseFloat(e.target.value)||p,l.forEach((i,t)=>{const d=t.getBoundingClientRect();i.style.backgroundSize=`${d.width*n}px ${d.height*n}px`})}))}function B(){document.querySelectorAll(".img-magnifier-glass").forEach(r=>r.remove()),l.clear(),a&&(a.disconnect(),a=null)}function S(r,f=I){r?z(f):B()}export{I as d,S as t};
